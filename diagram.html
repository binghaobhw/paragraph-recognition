<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>diagram</title>
    <script type='text/javascript'
            src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type='text/javascript'
            src="http://code.highcharts.com/highcharts.js"></script>
</head>
<body>
<div><input id='file' type='file' multiple/></div>
<div id="diagrams"></div>
<script type='text/javascript'>
    $(document).ready(function() {
        var followOptions = {
            title: {
                text: 'Follow'
            },
            chart: {
                type: 'line'
            },
            xAxis: {
                title: {
                    text: 'threshold'
                }
            },
            yAxis: {
                title: {
                    text: 'rate'
                }
            },
            series: []
        };
        var newOptions = {
            title: {
                text: 'New'
            },
            chart: {
                type: 'line'
            },
            xAxis: {
                title: {
                    text: 'threshold'
                }
            },
            yAxis: {
                title: {
                    text: 'rate'
                }
            },
            series: []
        };

        $('#file').live('change', function() {
            var files = $('#file').prop("files");
            $.map(files, function(val) {
                var path = 'data/' + val.name;
                var divFollowId = val.name + '.f';
                var divNewId = val.name + '.n';
                var divHeader = $('<div>' + val.name + '</div>');
                var divFollow = $('<div id="' + divFollowId + '", sty' + 'le="width:50%; float: left">');
                var divNew= $('<div id="' + divNewId + '", style="width:50%; float: left">');
                $("#diagrams").append(divHeader, divFollow, divNew);

                $.getJSON(path, function(data) {
                    var pFollow = [];
                    var rFollow = [];
                    var f1Follow = [];
                    var pNew = [];
                    var rNew = [];
                    var f1New = [];
                    for(var i = 0; i < data.length; i++) {
                        pFollow.push([data[i].threshold, data[i].result.F.P]);
                        rFollow.push([data[i].threshold, data[i].result.F.R]);
                        f1Follow.push([data[i].threshold, data[i].result.F.F1]);
                        pNew.push([data[i].threshold, data[i].result.N.P]);
                        rNew.push([data[i].threshold, data[i].result.N.R]);
                        f1New.push([data[i].threshold, data[i].result.N.F1]);
                    }
                    followOptions.series = []
                    followOptions.series.push({name: 'P', data: pFollow},
                            {name: 'R', data: rFollow}, {name: 'F1', data: f1Follow});
                    newOptions.series = []
                    newOptions.series.push({name: 'P', data: pNew},
                            {name: 'R', data: rNew}, {name: 'F1', data: f1New});
                    divFollow.highcharts(followOptions);
                    divNew.highcharts(newOptions);
                });
            });
        });
    });
</script>

</body>
</html>